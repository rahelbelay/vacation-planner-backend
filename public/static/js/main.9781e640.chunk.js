(this["webpackJsonpfrontend-capstone"]=this["webpackJsonpfrontend-capstone"]||[]).push([[0],{225:function(e,t,a){e.exports=a(452)},230:function(e,t,a){},451:function(e,t,a){},452:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),i=a(10),r=a.n(i),o=(a(230),a(73)),c=a(49),s=a(30),u=a(22),m=a(35),d=a(36),p=a(37),h=a(13),g=a.n(h),f=a(26),v=Object(f.a)(),b=a(500),y=a(490),E=a(216),w=a(488),S=a(5);g.a.defaults.withCredentials=!0;var C=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).onSubmit=function(e){e.preventDefault();var t={email:a.state.email,password:a.state.password};a.setState({loading:!0}),g.a.post("/api/login",t).then((function(e){a.setState({loginSuccess:!0,loading:!1})})).catch((function(e){a.setState({loading:!1})}))},a._handleEmail=function(e){a.setState({email:e.target.value})},a._handlePassword=function(e){a.setState({password:e.target.value})},a.state={email:"",password:"",loading:!1,loginSuccess:!1},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.classes;return this.state.loginSuccess?l.a.createElement(c.a,{to:"/my-trips"}):l.a.createElement("div",{className:"login-wrapper"},l.a.createElement("form",{noValidate:!0,autoComplete:"off",onSubmit:this.onSubmit},l.a.createElement(E.a,{className:"paper"},l.a.createElement(w.a,{className:e.title,variant:"h6"},"Login to your account"),l.a.createElement(b.a,{label:"Email",variant:"filled",fullWidth:!0,onChange:this._handleEmail,value:this.state.email,className:e.input}),l.a.createElement(b.a,{type:"password",label:"Password",variant:"filled",fullWidth:!0,onChange:this._handlePassword,value:this.state.password,className:e.input}),l.a.createElement(y.a,{type:"submit",variant:"contained",size:"medium",color:"primary",fullWidth:!0,className:e.action,disabled:this.state.loading},"Sign In"))))}}]),t}(l.a.Component),k=Object(S.a)((function(e){return{input:{marginBottom:"0.75em"},action:{marginTop:"1em"},title:{marginBottom:"1em"}}}))(C);g.a.defaults.withCredentials=!0;var _=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).onSubmit=function(e){e.preventDefault();var t={email:a.state.email,password:a.state.password,first_name:a.state.first_name,last_name:a.state.last_name};a.setState({loading:!0}),g.a.post("/api/signup",t).then((function(e){console.log("logged in successfully!"),a.setState({signUpSuccess:!0,loading:!1})})).catch((function(e){a.setState({loading:!1})}))},a._handleEmail=function(e){a.setState({email:e.target.value})},a._handlePassword=function(e){a.setState({password:e.target.value})},a._handleFirstName=function(e){a.setState({first_name:e.target.value})},a._handleLastName=function(e){a.setState({last_name:e.target.value})},a.state={email:"",password:"",first_name:"",last_name:"",signUpSuccess:!1},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.classes;return this.state.signUpSuccess?l.a.createElement(c.a,{to:"/login"}):l.a.createElement("div",{className:"login-wrapper"},l.a.createElement("form",{noValidate:!0,autoComplete:"off",onSubmit:this.onSubmit},l.a.createElement(E.a,{className:"paper"},l.a.createElement(w.a,{className:e.title,variant:"h6"},"Create an account"),l.a.createElement(b.a,{label:"Email",variant:"filled",fullWidth:!0,onChange:this._handleEmail,value:this.state.email,className:e.input}),l.a.createElement(b.a,{type:"password",label:"Password",variant:"filled",fullWidth:!0,onChange:this._handlePassword,value:this.state.password,className:e.input}),l.a.createElement(b.a,{label:"First Name",variant:"filled",fullWidth:!0,onChange:this._handleFirstName,value:this.state.first_name,className:e.input}),l.a.createElement(b.a,{label:"Last Name",variant:"filled",fullWidth:!0,onChange:this._handleLastName,value:this.state.last_name,className:e.input}),l.a.createElement(y.a,{fullWidth:!0,type:"submit",className:e.action,variant:"contained",color:"primary"},"Sign up"))))}}]),t}(l.a.Component),N=Object(S.a)((function(e){return{input:{marginBottom:"0.75em"},action:{marginTop:"1em"},title:{marginBottom:"1em"}}}))(_),x=a(53),j=a(501),O=a(209),I=a.n(O),B=a(493),P=a(491),T=a(206),M=a.n(T),D=a(207),A=a.n(D);var W={current:null},U=null,L=Object(P.a)((function(e){return{icon:{color:e.palette.text.secondary,marginRight:e.spacing(2)}}}));function F(e){var t=L(),a=l.a.useState(""),n=Object(x.a)(a,2),i=n[0],r=n[1],o=l.a.useState([]),c=Object(x.a)(o,2),s=c[0],u=c[1],m=l.a.useRef(!1);"undefined"===typeof window||m.current||(document.querySelector("#google-maps")||function(e,t,a){if(t){var n=document.createElement("script");n.setAttribute("async",""),n.setAttribute("id",a),n.src=e,t.appendChild(n)}}("https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyD_EXdqLdaexVtGyv3bE3B48-FdiBmgtBg","&libraries=geometry,drawing,places"),document.querySelector("head"),"google-maps"),m.current=!0);var d=function(e){r(e.target.value)},p=function(t,a){var n={lat:t.geometry.location.lat(),long:t.geometry.location.lng(),location:t.name,pictureUrl:t.photos&&t.photos[0]?t.photos[0].getUrl():""};e.onAutoComplete(n)},h=l.a.useMemo((function(){return A()((function(e,t){W.current.getPlacePredictions(e,t)}),200)}),[]);return l.a.useEffect((function(){var t=!0;if(!W.current&&window.google&&(W.current=new window.google.maps.places.AutocompleteService),window.google&&(U=new window.google.maps.places.PlacesService(document.createElement("div"))),W.current){if(""!==i){var a={input:i,types:[e.type]};return e.bounded&&(a.location=new window.google.maps.LatLng(e.lat,e.long),a.radius=1e3),h(a,(function(e){t&&u(e||[])})),function(){t=!1}}u([])}}),[i,h]),l.a.createElement(j.a,{style:{width:"100%"},getOptionLabel:function(e){return"string"===typeof e?e:e.description},options:s,autoComplete:!0,freeSolo:!0,includeInputInList:!0,onChange:function(e,t){t&&t.place_id&&function(e){var t={placeId:e,fields:["name","photo","formatted_address","place_id","geometry"]};U.getDetails(t,p)}(t.place_id)},disableOpenOnFocus:!0,renderInput:function(t){return l.a.createElement(b.a,Object.assign({},t,{label:e.label,variant:"outlined",fullWidth:!0,onChange:d}))},renderOption:function(e){var a=e.structured_formatting.main_text_matched_substrings,n=M()(e.structured_formatting.main_text,a.map((function(e){return[e.offset,e.offset+e.length]})));return l.a.createElement(B.a,{container:!0,alignItems:"center"},l.a.createElement(B.a,{item:!0},l.a.createElement(I.a,{className:t.icon})),l.a.createElement(B.a,{item:!0,xs:!0},n.map((function(e,t){return l.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})),l.a.createElement(w.a,{variant:"body2",color:"textSecondary"},e.structured_formatting.secondary_text)))}})}g.a.defaults.withCredentials=!0;var z=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).onAutoComplete=function(e){var t=e.lat,n=e.long,l=e.location,i=e.pictureUrl;a.setState({lat:t,long:n,location:l,pictureUrl:i})},a.onSubmit=function(e){e.preventDefault();var t={location:a.state.location,lat:a.state.lat,long:a.state.long,day:a.state.day,pictureUrl:a.state.pictureUrl};a.setState({loading:!0}),g.a.post("/api/create/trip",t).then((function(e){console.log("trip sucess!"),a.setState({createdSuccessfully:!0,loading:!1})})).catch((function(e){console.log("trip failed"),a.setState({loading:!1})}))},a._handleLocation=function(e){a.setState({location:e.target.value})},a._handleDay=function(e){a.setState({day:e.target.value})},a.state={location:"",day:"",loading:!1,createdSuccessfully:!1},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(){this.state.createdSuccessfully&&(this.setState({location:"",day:"",loading:!1,createdSuccessfully:!1}),v.push("/my-trips"))}},{key:"render",value:function(){var e=this.props.classes;return this.state.createdSuccessfully?l.a.createElement(c.a,{to:"/my-trips"}):l.a.createElement("div",{className:e.container},l.a.createElement(w.a,{className:e.title,variant:"h4"},"Discover new places"),l.a.createElement("div",{className:"login-wrapper"},l.a.createElement("form",{noValidate:!0,autoComplete:"off",onSubmit:this.onSubmit},l.a.createElement(E.a,{className:"paper"},l.a.createElement(F,{label:"Where would you like to go?",type:"geocode",onAutoComplete:this.onAutoComplete}),l.a.createElement(b.a,{label:"How many days ...",fullWidth:!0,className:e.input,variant:"filled",onChange:this._handleDay,value:this.state.day}),l.a.createElement(y.a,{type:"submit",className:e.action,variant:"contained",color:"primary",fullWidth:!0},"Create Trip")))))}}]),t}(l.a.Component),q=Object(S.a)((function(e){return{input:{marginBottom:"0.75em",marginTop:"1em"},action:{marginTop:"1em"},title:{color:"white"},container:{backgroundImage:"url('https://images8.alphacoders.com/541/541025.jpg')",backgroundSize:"cover",backgroundRepeat:"no-repeat",height:"100%",width:"100%"}}}))(z),H=a(131),R=a.n(H),G=a(210),V=a(494),J=a(495),X=a(496);g.a.defaults.withCredentials=!0;var Q=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e)))._handleClick=function(e){console.log(a.props),a.props.history.push("/trip-detail/".concat(e))},a._getAllTripsByUserId=Object(G.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),e.next=3,g.a.get("/api/my-trips").then((function(e){console.log(e.data.result),a.setState({trips:e.data.result,loading:!1}),console.log(a.state.trips)})).catch((function(e){console.log(e),console.log("no event"),a.setState({loading:!1})}));case 3:case"end":return e.stop()}}),e)}))),a.state={trips:[],loading:!1},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this._getAllTripsByUserId()}},{key:"render",value:function(){var e=this,t=this.props.classes;return this.state.trips&&0!==this.state.trips.length?l.a.createElement("div",null,this.state.loading&&l.a.createElement("h1",null,"loading..."),l.a.createElement("div",{className:"card-container"},this.state.trips&&this.state.trips.map((function(a){return l.a.createElement(V.a,{className:t.card,style:{backgroundImage:"url('".concat(a.picture_url,"')")}},l.a.createElement("div",{className:t.overlay}),l.a.createElement(J.a,{className:t.cardAction,onClick:function(){return e._handleClick(a.id)}},l.a.createElement(X.a,null,l.a.createElement(w.a,{className:t.text,variant:"h5",align:"left"},a.location),l.a.createElement(w.a,{className:t.text,variant:"subtitle1",align:"left"},"Trip for ".concat(a.day," days")))))})))):l.a.createElement("div",{className:"crate-trip"},l.a.createElement("div",null,l.a.createElement(w.a,{variant:"h4"},"You don't have any trips, why don't you create one")),l.a.createElement("div",{className:"create-button"},l.a.createElement(y.a,{variant:"contained",href:"/create-trip"},"Create Trip")))}}]),t}(l.a.Component),Y=Object(S.a)((function(e){return{text:{color:"white"},card:{position:"relative",width:"320px",minHeight:"175px",margin:"10px",backgroundSize:"cover",backgroundRepeat:"no-repeat"},cardAction:{display:"flex",alignItems:"flex-start",height:"100%",justifyContent:"flex-end",flexDirection:"column"},overlay:{height:"100%",minHeight:"1px",width:"100%",position:"absolute",backgroundColor:"#00000075"}}}))(Q),Z=a(211),K=a(11),$=a(497),ee=a(132),te=a(74),ae=Object(ee.a)(Object(ee.b)({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyD_EXdqLdaexVtGyv3bE3B48-FdiBmgtBg","&v=3.exp&libraries=geometry,drawing,places"),loadingElement:l.a.createElement("div",{style:{height:"100%"}}),containerElement:l.a.createElement("div",{style:{height:"400px"}}),mapElement:l.a.createElement("div",{style:{height:"100%"}})}),te.withScriptjs,te.withGoogleMap)((function(e){return l.a.createElement(te.GoogleMap,{defaultZoom:8,defaultCenter:{lat:e.lat,lng:e.long}},e.isMarkerShown&&l.a.createElement(te.Marker,{position:{lat:e.lat,lng:e.long},onClick:e.onMarkerClick}))})),ne=a(492),le=a(215),ie=a.n(le);g.a.defaults.withCredentials=!0;var re=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).delayedShowMarker=function(){setTimeout((function(){a.setState({isMarkerShown:!0})}),3e3)},a.handleMarkerClick=function(){a.setState({isMarkerShown:!1}),a.delayedShowMarker()},a._handleQuery=function(e){a.setState({query:e.target.value})},a._onAutoComplete=function(e){var t={latitude:e.lat,longitude:e.long,name:e.location,type:"default",pictureUrl:e.pictureUrl,tripId:a.state.trip.id};a.savePlace(t)},a.savePlace=function(e){g.a.post("/api/create/places",e).then((function(t){console.log(t),console.log("place sucess!");var n=a.state.savedPlaces;n.push(Object(Z.a)({},e,{id:t.data.newPlaceId})),a.setState({savedPlaces:n});var l=a.props.match.params.id;a._getSavedPlacesByTripId(l)})).catch((function(e){console.log("place failed"),a.setState({loading:!1})}))},a._handleDelete=function(e){g.a.delete("/api/saved-places/".concat(e)).then((function(t){var n=a.state.savedPlaces.filter((function(t){return t.id!==e}));a.setState({savedPlaces:n})})).catch((function(e){console.log(e),console.log("error deleting trip "),a.setState({loading:!1})}))},a._getTripDetailById=function(e){a.setState({loading:!0}),g.a.get("/api/trip-detail/".concat(e)).then((function(e){console.log(e.data.result),a.setState({trip:e.data.result,loading:!1}),a._getTripWeather()})).catch((function(e){console.log(e),console.log("no event"),a.setState({loading:!1})}))},a._getSavedPlacesByTripId=function(e){a.setState({loading:!0}),g.a.get("/api/saved-places-detail/".concat(e)).then((function(e){a.setState({savedPlaces:e.data.result,loading:!1})})).catch((function(e){console.log(e),console.log("no event"),a.setState({loading:!1})}))},a._getTripWeather=function(){g.a.get("https://api.openweathermap.org/data/2.5/weather?q=".concat(a.state.trip.location,"&appid=").concat("c3e8793eb809694aee4ce6c2e1bf2551"),{withCredentials:!1}).then((function(e){console.log(e.data.weather[0].description);var t=Math.round(9*(e.data.main.temp-273.15)/5+32);a.setState({currentWeather:e.data.weather[0].description,weatherIcon:"http://openweathermap.org/img/wn/".concat(e.data.weather[0].icon,"@2x.png"),currentTemp:t})})).catch((function(e){console.log(e),console.log("no event")}))},a.state={trip:{},currentWeather:"",currentTemp:"",redirect:!1,loading:!1,query:"",savedPlaces:[],isMarkerShown:!1,createdSuccessfully:!1},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.id;this._getTripDetailById(e),this._getSavedPlacesByTripId(e),this.delayedShowMarker()}},{key:"render",value:function(){var e=this,t=this.props.classes;return this.state.loading?l.a.createElement($.a,null):l.a.createElement("div",{className:t.container},l.a.createElement(B.a,{container:!0,spacing:3},l.a.createElement(B.a,{item:!0,xs:6,sm:6},l.a.createElement("div",{className:t.autocomplete},l.a.createElement(F,{type:"establishment",label:"Search for places to visit",onAutoComplete:this._onAutoComplete,bounded:!0,lat:this.state.trip.lat,long:this.state.trip.long})),this.state.savedPlaces&&this.state.savedPlaces.length>0&&this.state.savedPlaces.map((function(a){return l.a.createElement("div",{className:"autocomplete-place"},l.a.createElement(V.a,{key:a.id,className:t.weatherContainer,style:{backgroundImage:"url('".concat(a.picture_url,"')")}},l.a.createElement("div",{className:t.overlay}),l.a.createElement(X.a,{className:t.cardContent},l.a.createElement(w.a,{className:t.text,gutterBottom:!0,variant:"subtitle2"},a.name),l.a.createElement(ne.a,{style:{color:"white"},"aria-label":"delete",onClick:function(){return e._handleDelete(a.id)}},l.a.createElement(ie.a,null)))))}))),l.a.createElement(B.a,{item:!0,xs:12,sm:6},l.a.createElement(V.a,{className:t.card,style:{backgroundImage:"url('".concat(this.state.trip.picture_url,"')")}},l.a.createElement("div",{className:t.overlay}),l.a.createElement(X.a,{className:t.cardAction},l.a.createElement("img",{className:t.weatherIcon,src:this.state.weatherIcon}),l.a.createElement(w.a,{className:t.text,variant:"h5",align:"left"},this.state.trip.location),l.a.createElement(w.a,{className:t.text,variant:"subtitle1",align:"left"},this.state.currentTemp,"\u02daF ",this.state.currentWeather)),l.a.createElement(w.a,{gutterBottom:!0,variant:"h6",component:"h2",align:"left"})),l.a.createElement(ae,{isMarkerShown:this.state.isMarkerShown,onMarkerClick:this.handleMarkerClick,lat:parseFloat(this.state.trip.lat),long:parseFloat(this.state.trip.long)}))))}}]),t}(l.a.Component),oe=Object(S.a)((function(e){var t;return t={container:{display:"flex",margin:"2em",flexDirection:"column"},input:{marginBottom:"0.75em"},action:{marginTop:"1em"},title:{marginBottom:"1em"},weatherIcon:{zIndex:100},text:{color:"white",zIndex:100},cardContent:{display:"flex",justifyContent:"space-between",padding:"10px",color:"white"},card:{position:"relative",width:"100%",minHeight:"175px",backgroundSize:"cover",backgroundRepeat:"no-repeat",marginBottom:"2em"},cardAction:{display:"flex",alignItems:"flex-start",height:"100%",justifyContent:"flex-end",flexDirection:"column"},overlay:{height:"100%",minHeight:"1px",width:"100%",position:"absolute",backgroundColor:"#00000075"},autocomplete:{paddingBottom:"2em"},weatherContainer:{display:"flex",flexDirection:"column",alignContent:"space-between",justifyContent:"space-around",marginTop:"4px",position:"relative",width:"100%",maxHeight:"70px",backgroundSize:"cover",backgroundRepeat:"no-repeat"}},Object(K.a)(t,"cardContent",{display:"flex",height:"100%",justifyContent:"space-between"}),Object(K.a)(t,"overlay",{height:"100%",minHeight:"1px",width:"100%",position:"absolute",backgroundColor:"#00000075"}),t}))(re),ce=a(498),se=a(499),ue=Object(P.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},toolbar:{display:"flex",justifyContent:"space-between",backgroundColor:"#1a8399"},link:{color:"white"}}}));function me(){var e=ue();return l.a.createElement("div",Object(K.a)({className:e.root},"className","container"),l.a.createElement(ce.a,{position:"static"},l.a.createElement(se.a,{className:e.toolbar},l.a.createElement("div",null,l.a.createElement(y.a,{className:e.link,href:"/"},"Create Trip"),l.a.createElement(y.a,{className:e.link,href:"/my-trips"},"My Trips")),l.a.createElement("div",null,l.a.createElement(y.a,{className:e.link,href:"/login"},"Log in"),l.a.createElement(y.a,{className:e.link,href:"/signup"},"Sign up")))))}a(451);r.a.render(l.a.createElement((function(){return l.a.createElement(o.a,{history:v},l.a.createElement(l.a.Fragment,null,l.a.createElement(me,null),l.a.createElement(c.d,null,l.a.createElement(c.b,{path:"/my-trips",render:function(e){return l.a.createElement(Y,e)}}),l.a.createElement(c.b,{path:"/signup"},l.a.createElement(N,null)),l.a.createElement(c.b,{path:"/login"},l.a.createElement(k,null)),l.a.createElement(c.b,{exact:!0,path:"/"},l.a.createElement(q,null)),l.a.createElement(c.b,{path:"/trip-detail/:id",render:function(e){return l.a.createElement(oe,e)}}))))}),null),document.getElementById("root"))}},[[225,1,2]]]);
//# sourceMappingURL=main.9781e640.chunk.js.map